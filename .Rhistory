crs = st_crs(illinois))
View(mcmf)
mcmf %>%
count(geogrphic_cluster_name)
mcmf %>%
count(geographic_cluster_name)
tbl <- mcmf %>%
count(geographic_cluster_name)
View(tbl)
tbl <- mcmf %>%
filter(meeting_type == "face_to_face") %>%
count(geographic_cluster_name)
View(tbl)
mcmf %>%
count(meeting_type == "face_to_face")
mcmf %>%
+     count(meeting_type)
mcmf %>%
count(meeting_type)
View(mcmf)
tbl <- mcmf %>%
filter(meeting_type == "face_to_face") %>%
skimr::skim_without_charts()
mcmf %>%
filter(meeting_type == "face_to_face") %>%
skimr::skim_without_charts()
View(map)
install.packages("censusxy")
library(censusxy)
censusxy::cxy_single("3700 Lindell Blvd", "St. Louis", "MO", 63139)
onesec <- censusxy::cxy_single("3700 Lindell Blvd", "St. Louis", "MO", 63139)
View(onesec)
onesec <- censusxy::cxy_single("3700 Lindell Blvd", "St. Louis", "MO", 63139) %>%
colnames()
df <- censusxy::cxy_single("3700 Lindell Blvd", "St. Louis", "MO", 63139) %>%
colnames() %>%
purrr::map_dfc(setNames, object = list(character()))
View(df)
df <- censusxy::cxy_single("3700 Lindell Blvd", "St. Louis", "MO", 63139) %>%
mutate(address = "HAHA") %>%
colnames() %>%
purrr::map_dfc(setNames, object = list(character()))
View(df)
for i in len(mcmf){
for (i in len(mcmf)){
fornow <- cxy_single(address[i]) %>%
mutate(address = address[i])
bind_rows(df, fornow)
}
for (i in mcmf){
fornow <- cxy_single(address[i]) %>%
mutate(address = address[i])
bind_rows(df, fornow)
}
for (i in mcmf){
fornow <- cxy_single(address[i, ]) %>%
mutate(address = address[i, ])
bind_rows(df, fornow)
}
for (i in mcmf){
fornow <- cxy_single(mcmf[i, ]$address) %>%
mutate(address = mcmf[i, ]$address)
bind_rows(df, fornow)
}
df <- censusxy::cxy_single("3700 Lindell Blvd", "St. Louis", "MO", 63139) %>%
## mutate(address = "HAHA") %>%
colnames() %>%
purrr::map_dfc(setNames, object = list(character()))
for (i in mcmf){
fornow <- cxy_single(mcmf[i, ]$address) ## %>%
## mutate(address = mcmf[i, ]$address)
bind_rows(df, fornow)
}
cxy_single(mcmf[1, ]$address)
View(mcmf)
cxy_single(560 W Lake Street)
check <- cxy_single("560 W Lake Street")
check <- cxy_single("560 W Lake Street Chicago IL 60661")
check <- cxy_single("560 W Lake Street", "Chicago", "IL", "60661")
View(check)
View(mcmf)
View(mcmf)
list = (mcmf[1, ]$address, mcmf[1, ]$city, mcmf[1, ]$state, mcmf[1, ]$zipcode)
list = (mcmf[1]$address, mcmf[1]$city, mcmf[1]$state, mcmf[1]$zipcode)
list = [mcmf[1, ]$address, mcmf[1, ]$city, mcmf[1, ]$state, mcmf[1, ]$zipcode]
list = (toString(mcmf[1, ]$address), toString(mcmf[1, ]$city), toString(mcmf[1, ]$state), toString(mcmf[1, ]$zipcode))
list = list(toString(mcmf[1, ]$address), toString(mcmf[1, ]$city), toString(mcmf[1, ]$state), toString(mcmf[1, ]$zipcode))
View(list)
for (i in mcmf){
list = list(toString(mcmf[i, ]$address), toString(mcmf[i, ]$city), toString(mcmf[i, ]$state), toString(mcmf[i, ]$zipcode))
fornow <- cxy_single(list) ## %>%
## mutate(address = mcmf[i, ]$address)
bind_rows(df, fornow)
}
i = 1
list = list(toString(mcmf[i, ]$address), toString(mcmf[i, ]$city), toString(mcmf[i, ]$state), toString(mcmf[i, ]$zipcode))
fornow <- cxy_single(list)
for (i in mcmf){
list = list(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode)
fornow <- cxy_single(list) ## %>%
## mutate(address = mcmf[i, ]$address)
bind_rows(df, fornow)
}
for (i in mcmf){
list = list(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode)
fornow <- cxy_single(list) ## %>%
## mutate(address = mcmf[i, ]$address)
df <- bind_rows(df, fornow)
}
i <- 1
list = list(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode)
fornow <- cxy_single(list)
fornow <- cxy_single(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode)
View(fornow)
for (i in mcmf){
## list = list(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode)
fornow <- cxy_single(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode) %>%
mutate(address = mcmf[i, ]$address)
df <- bind_rows(df, fornow)
}
View(fornow)
i <- 1
fornow <- cxy_single(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode) %>%
mutate(address = mcmf[i, ]$address)
View(fornow)
fornow %>% colnames()
View(df)
df <- censusxy::cxy_single("3700 Lindell Blvd", "St. Louis", "MO", 63139) %>%
mutate(address = "HAHA") %>%
colnames() %>%
purrr::map_dfc(setNames, object = list(character()))
for (i in mcmf){
## list = list(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode)
fornow <- cxy_single(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode) %>%
mutate(address = mcmf[i, ]$address)
df <- bind_rows(df, fornow)
}
for (i in length(mcmf)){
## list = list(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode)
fornow <- cxy_single(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode) %>%
mutate(address = mcmf[i, ]$address)
df <- bind_rows(df, fornow)
}
for (i in 1:nrow(mcmf)){
## list = list(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode)
fornow <- cxy_single(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode) %>%
mutate(address = mcmf[i, ]$address)
df <- bind_rows(df, fornow)
}
df <- censusxy::cxy_single("3700 Lindell Blvd", "St. Louis", "MO", 63139) %>%
mutate(address = "HAHA") %>%
colnames() %>%
purrr::map_dfc(setNames, object = list(character()))
for (i in 1:nrow(mcmf)){
## list = list(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode)
fornow <- cxy_single(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode) %>%
mutate(address = mcmf[i, ]$address) %>%
mutate(across(everything(), as.character))
df <- bind_rows(df, fornow)
}
nrow(mcmf)
## list = list(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode)
fornow <- cxy_single(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode) %>%
mutate(address = mcmf[i, ]$address) %>%
mutate_all(as.character)
i <- 1
fornow <- cxy_single(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode) %>%
mutate(address = mcmf[i, ]$address)
fornow %>% mutate_all(as.character)
fornow2 <- fornow %>% mutate_all(as.character)
View(fornow2)
df <- censusxy::cxy_single("3700 Lindell Blvd", "St. Louis", "MO", 63139) %>%
mutate(address = "HAHA") %>%
colnames() %>%
purrr::map_dfc(setNames, object = list(character()))
for (i in 1:nrow(mcmf)){
## list = list(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode)
fornow <- cxy_single(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode) %>%
mutate(address = mcmf[i, ]$address) %>%
mutate_all(as.character)
df <- bind_rows(df, fornow)
}
## libraries
library(tidyverse)
library(ggplot2)
library(sf)
library(tigris)
function (.x, .f, ...)
library(censusxy)
library(censusxy)
## load data
mcmf <- read_tsv("data/convert_MCMF_ALL_TIME_DATA.csv") %>%
janitor::clean_names() %>%
# convert longitude, latitude to one column of points
st_as_sf(coords = c("longitude", "latitude"),
## within illinois coordinate reference system
crs = st_crs(illinois))
mcmf <- read_tsv("data/convert_MCMF_ALL_TIME_DATA.csv") %>%
janitor::clean_names()
map <- read_csv("data/mcmf_map.csv") %>%
janitor::clean_names()
df <- censusxy::cxy_single("3700 Lindell Blvd", "St. Louis", "MO", 63139) %>%
mutate(address = "HAHA") %>%
colnames() %>%
purrr::map_dfc(setNames, object = list(character()))
df <- censusxy::cxy_single("3700 Lindell Blvd", "St. Louis", "MO", 63139) %>%
mutate(address = "HAHA") %>%
colnames() %>%
purrr::map_dfc(setNames, object = list(character()))
for (i in 1:nrow(mcmf)){
## list = list(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode)
fornow <- cxy_single(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode) %>%
mutate(address = mcmf[i, ]$address) %>%
mutate_all(as.character)
df <- bind_rows(df, fornow)
}
i <- 1
fornow <- cxy_single(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode) %>%
mutate(address = mcmf[i, ]$address) %>%
mutate_all(as.character)
fornow
df2 <- bind_rows(df, fornow)
View(df2)
View(fornow)
View(df)
df <- censusxy::cxy_single("3700 Lindell Blvd", "St. Louis", "MO", 63139) %>%
mutate(address = "HAHA") %>%
colnames() %>%
purrr::map_dfc(setNames, object = list(character()))
df2 <- bind_rows(df, fornow)
View(df2)
mcmf2 <- mcmf %>%
filter(!is.na(address))
## list = list(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode)
fornow <- cxy_single(mcmf2[i, ]$address, mcmf2[i, ]$city, mcmf2[i, ]$state, mcmf2[i, ]$zipcode) %>%
mutate(address = mcmf2[i, ]$address) %>%
mutate_all(as.character)
for (i in 1:nrow(mcmf2)){
## list = list(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode)
fornow <- cxy_single(mcmf2[i, ]$address, mcmf2[i, ]$city, mcmf2[i, ]$state, mcmf2[i, ]$zipcode) %>%
mutate(address = mcmf2[i, ]$address) %>%
mutate_all(as.character)
df <- bind_rows(df, fornow)
}
View(df)
View(mcmf2)
mcmf2 %>% skimr::skim_without_charts()
mcmf2 <- mcmf %>%
filter(!is.na(address)) %>%
filter(!is.na(city)) %>%
filter(!is.na(zipcode)) %>%
filter(!is.na(state))
View(mcmf2)
for (i in 1:nrow(mcmf2)){
## list = list(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode)
fornow <- cxy_single(mcmf2[i, ]$address, mcmf2[i, ]$city, mcmf2[i, ]$state, mcmf2[i, ]$zipcode) %>%
mutate(address = mcmf2[i, ]$address) %>%
mutate_all(as.character)
df <- bind_rows(df, fornow)
}
for (i in 1:nrow(mcmf2)){
## list = list(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode)
fornow <- cxy_single(mcmf2[i, ]$address, mcmf2[i, ]$city, mcmf2[i, ]$state, mcmf2[i, ]$zipcode) %>%
fornow <- fornow %>%
mutate(address = mcmf2[i, ]$address) %>%
mutate_all(as.character)
df <- bind_rows(df, fornow)
}
for (i in 1:nrow(mcmf2)){
## list = list(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode)
fornow <- cxy_single(mcmf2[i, ]$address, mcmf2[i, ]$city, mcmf2[i, ]$state, mcmf2[i, ]$zipcode)
fornow <- fornow %>%
mutate(address = mcmf2[i, ]$address) %>%
mutate_all(as.character)
df <- bind_rows(df, fornow)
}
View(df)
View(mcmf2)
View(df)
View(mcmf2)
## libraries
library(tidyverse)
library(ggplot2)
library(sf)
library(tigris)
library(censusxy)
## load data
mcmf <- read_tsv("data/convert_MCMF_ALL_TIME_DATA.csv") %>%
janitor::clean_names() # %>%
mcmf %>%
filter(meeting_type == "face_to_face") %>%
skimr::skim_without_charts()
map <- read_csv("data/mcmf_map.csv") %>%
janitor::clean_names()
censusxy::cxy_single("3700 Lindell Blvd", "St. Louis", "MO", 63139)
df <- censusxy::cxy_single("3700 Lindell Blvd", "St. Louis", "MO", 63139) %>%
mutate(address = "HAHA") %>%
colnames() %>%
purrr::map_dfc(setNames, object = list(character()))
mcmf2 <- mcmf %>%
filter(!is.na(address)) %>%
filter(!is.na(city)) %>%
filter(!is.na(zipcode)) %>%
filter(!is.na(state))
## list = list(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode)
fornow <- cxy_single(mcmf2[i, ]$address, mcmf2[i, ]$city, mcmf2[i, ]$state, mcmf2[i, ]$zipcode)
for (i in 1:nrow(mcmf2)){
## list = list(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode)
fornow <- cxy_single(mcmf2[i, ]$address, mcmf2[i, ]$city, mcmf2[i, ]$state, mcmf2[i, ]$zipcode)
fornow <- fornow %>%
mutate(address = mcmf2[i, ]$address) %>%
mutate_all(as.character)
df <- bind_rows(df, fornow)
}
View(df)
cxy_single("1200 West Harrison St., Suite #2560", "Chicago", "IL", 60607)
cxy_single("4753 N Broadway 4th floor", "Chicago", "IL", 60640)
?cxy_single
## libraries
library(tidyverse)
library(ggplot2)
library(sf)
library(tigris)
library(censusxy)
## load data
mcmf <- read_tsv("data/convert_MCMF_ALL_TIME_DATA.csv") %>%
janitor::clean_names() # %>%
mcmf %>%
filter(meeting_type == "face_to_face") %>%
skimr::skim_without_charts()
map <- read_csv("data/mcmf_map.csv") %>%
janitor::clean_names()
df <- censusxy::cxy_single("3700 Lindell Blvd", "St. Louis", "MO", 63139) %>%
mutate(address = "HAHA") %>%
colnames() %>%
purrr::map_dfc(setNames, object = list(character()))
mcmf2 <- mcmf %>%
filter(!is.na(address)) %>%
filter(!is.na(city)) %>%
filter(!is.na(zipcode)) %>%
filter(!is.na(state))
for (i in 1:nrow(mcmf2)){
## list = list(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode)
fornow <- cxy_single(mcmf2[i, ]$address, mcmf2[i, ]$city, mcmf2[i, ]$state, mcmf2[i, ]$zipcode)
if (fornow = NULL) {
for (i in 1:nrow(mcmf2)){
## list = list(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode)
fornow <- cxy_single(mcmf2[i, ]$address, mcmf2[i, ]$city, mcmf2[i, ]$state, mcmf2[i, ]$zipcode)
if (fornow == NULL) {
next
}
fornow <- fornow %>%
mutate(address = mcmf2[i, ]$address) %>%
mutate_all(as.character)
df <- bind_rows(df, fornow)
}
for (i in 1:nrow(mcmf2)){
## list = list(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode)
fornow <- cxy_single(mcmf2[i, ]$address, mcmf2[i, ]$city, mcmf2[i, ]$state, mcmf2[i, ]$zipcode)
if (is.null(fornow)){
next
}
fornow <- fornow %>%
mutate(address = mcmf2[i, ]$address) %>%
mutate_all(as.character)
df <- bind_rows(df, fornow)
}
mcmf2 <- mcmf %>%
filter(!is.na(address)) %>%
filter(!is.na(city)) %>%
filter(!is.na(zipcode)) %>%
filter(!is.na(state)) %>%
filter(is.na(latitude))
mcmf2 <- mcmf %>%
filter(!is.na(address)) %>%
filter(!is.na(city)) %>%
filter(!is.na(zipcode)) %>%
filter(!is.na(state)) %>%
filter(is.na(latitude)) %>%
select(address, city, zipcode, state) %>%
ditinct()
mcmf2 <- mcmf %>%
filter(!is.na(address)) %>%
filter(!is.na(city)) %>%
filter(!is.na(zipcode)) %>%
filter(!is.na(state)) %>%
filter(is.na(latitude)) %>%
select(address, city, zipcode, state) %>%
distinct()
for (i in 1:nrow(mcmf2)){
## list = list(mcmf[i, ]$address, mcmf[i, ]$city, mcmf[i, ]$state, mcmf[i, ]$zipcode)
fornow <- cxy_single(mcmf2[i, ]$address, mcmf2[i, ]$city, mcmf2[i, ]$state, mcmf2[i, ]$zipcode)
if (is.null(fornow)){
next
}
fornow <- fornow %>%
mutate(address = mcmf2[i, ]$address) %>%
mutate_all(as.character)
df <- bind_rows(df, fornow)
}
for (i in 1:nrow(mcmf2)){
cxy_out <- cxy_single(mcmf2[i, ]$address, mcmf2[i, ]$city, mcmf2[i, ]$state, mcmf2[i, ]$zipcode)
if (is.null(cxy_out)){
next
}
cxy_out <- cxy_out %>%
mutate(address = mcmf2[i, ]$address) %>%
mutate_all(as.character)
df <- bind_rows(df, cxy_out)
}
View(df)
df2 <- df %>%
distinct()
df2 <- df %>%
select(address, starts_with("coordinate"))
View(df2)
df2 <- df %>%
select(address, starts_with("coordinate")) %>%
distinct()
View(df2)
df2 <- df %>%
select(address, coordinates.x, coordinates.y) %>%
distinct()
View(df2)
df3 <- df %>%
select(address) %>%
distinct()
View(df3)
View(mcmf2)
mcmf2 <- mcmf %>%
filter(!is.na(address)) %>%
filter(!is.na(city)) %>%
filter(!is.na(zipcode)) %>%
filter(!is.na(state)) %>%
filter(is.na(latitude)) %>%
select(address, city, zipcode, state) %>%
distinct()
mcmf_impute <- mcmf %>%
filter(is.na(latitude))
mcmf_impute <- mcmf %>%
filter(is.na(latitude)) %>%
left_join(df2, by = "address")
View(mcmf_impute)
mcmf_impute <- mcmf %>%
filter(is.na(latitude)) %>%
left_join(df2)
View(mcmf_impute)
mcmf_impute %>% skimr::skim_without_charts()
mcmf_impute <- mcmf %>%
filter(meeting_type == "face_to_face") %>%
filter(!is.na(address)) %>%
filter(!is.na(city)) %>%
filter(!is.na(zipcode)) %>%
filter(!is.na(state)) %>%
filter(is.na(latitude)) %>%
left_join(df2)
View(mcmf_impute)
mcmf_hasxy <- mcmf %>%
filter(!is.na(latitude))
mcmf_map <- mcmf %>%
filter(!is.na(latitude)) %>%
bind_rows(mcmf_impute)
View(mcmf_impute)
View(mcmf_map)
mcmf_map2 <- mcmf_map %>%
mutate(latitude = dplyr::coalesce(latitude, coordinates.x)) %>%
mutate(longitude = dplyr::coalesce(longitude, coordinates.y))
mcmf_map2 <- mcmf_map %>%
mutate(latitude = as.character(latitude)) %>%
mutate(longitude = as.character(longitude)) %>%
mutate(latitude = dplyr::coalesce(latitude, coordinates.x)) %>%
mutate(longitude = dplyr::coalesce(longitude, coordinates.y))
View(mcmf_map2)
mcmf_map2 <- mcmf_map %>%
mutate(latitude = as.character(latitude)) %>%
mutate(longitude = as.character(longitude)) %>%
mutate(latitude = dplyr::coalesce(latitude, coordinates.x)) %>%
mutate(longitude = dplyr::coalesce(longitude, coordinates.y)) %>%
filter(!is.na(latitude)) %>%
filter(!is.na(longitude))
mcmf_map <- mcmf %>%
filter(!is.na(latitude)) %>%
bind_rows(mcmf_impute) %>%
mutate(latitude = as.character(latitude)) %>%
mutate(longitude = as.character(longitude)) %>%
mutate(latitude = dplyr::coalesce(latitude, coordinates.x)) %>%
mutate(longitude = dplyr::coalesce(longitude, coordinates.y)) %>%
filter(!is.na(latitude)) %>%
filter(!is.na(longitude))
View(mcmf_map)
mcmf_map <- mcmf %>%
filter(!is.na(latitude)) %>%
bind_rows(mcmf_impute) %>%
mutate(latitude = as.character(latitude)) %>%
mutate(longitude = as.character(longitude)) %>%
mutate(latitude = dplyr::coalesce(latitude, coordinates.x)) %>%
mutate(longitude = dplyr::coalesce(longitude, coordinates.y)) %>%
filter(!is.na(latitude)) %>%
filter(!is.na(longitude)) %>%
select(-c(starts_with("coordinates")))
mcmf_map2 <- mcmf_map %>%
# convert longitude, latitude to one column of points
st_as_sf(coords = c("longitude", "latitude"),
# within illinois coordinate reference system
crs = st_crs(illinois))
illinois <- tidycensus::get_acs(state = "IL", geography = "tract",
variables = "B19013_001", geometry = TRUE)
mcmf_map2 <- mcmf_map %>%
# convert longitude, latitude to one column of points
st_as_sf(coords = c("longitude", "latitude"),
# within illinois coordinate reference system
crs = st_crs(illinois))
